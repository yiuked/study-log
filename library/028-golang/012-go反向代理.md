# GO配置反向代理
```
// 定义路由
admin.POST("/sms/query", ReverseProxy)

// 被指向的函数
func ReverseProxy(c *gin.Context) {
  // 设置反向代理参数
	var proxy = &httputil.ReverseProxy{
		Director: func(req *http.Request) {
			req.Header.Set("token", utils.GetProxyToken())
			req.URL.Scheme = utils.Config("proxy.url.scheme")
			req.URL.Host = utils.Config("proxy.url.host")
		},
	}

  // 修改返回信息
	proxy.ModifyResponse = func(response *http.Response) error {
		buf, err := ioutil.ReadAll(response.Body)
    //  body读取一次会自动close，需要重新赋值
		response.Body = ioutil.NopCloser(bytes.NewBuffer(buf))
		if err == nil {
      // 自己按自己的格式解析
			resp := &models.Response{}
			json.Unmarshal(buf, resp)

			if resp.RespCode == "1005" {
				response.StatusCode = 403
				response.Status = http.StatusText(403)

				str := "change after date"
				response.Body = ioutil.NopCloser(bytes.NewBufferString(str))
        // 新的Body与原body不一致，需要重新写入【重要，否则会出现:ERR_CONTENT_LENGTH_MISMATCH】
				response.Header.Set("Content-Length",strconv.Itoa(bytes.NewBufferString(str).Len()))
			}
		}
		return nil
	}
	proxy.ServeHTTP(c.Writer, c.Request)
}
```
