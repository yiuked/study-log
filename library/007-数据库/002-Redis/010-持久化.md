## 一、RDB 快照 

### 1.1  概述

快照是默认的持久化方式，这种方式 是将内存数据以快照的方式写入二进制文件中，默认保存文件名为dump.rdb

### 1.2 优点

* 保存数据极快，还原数据极快，适用于灾难备份

### 1.3 缺点

* 小内存机器不适合使用，备份时会消耗大量内存，RDB机制符合要求就会产生快照

### 1.4 配置

redis.conf

```
save 900 1      // 每900秒至少1个key发生变化，产生快照 
save 300 10     // 每300秒至少10个key发生变化，产生快照
save 60 10000   // 第60秒至少10000个key发生变化，产生快照
```



## 二、AOF方式

### 2.1 概述

快照是基于一定时间间隔产生，如果redis意外退出，就会丢失最后最一次修改，因此产生aof持久化方式。aof全称 append only file,redis每收到一个写命令后都会追加到appendonly.aof文件中，当服务重启时，可通过appendonly.aof重新加载数据库内容。

### 2.2 优点

* 因时间间隔产生数据丢失的几率减少

### 2.3 缺点

* 持久化文件会越来越大

### 2.4 配置

redis.conf

```
# 启用aof持久化
appendonly yes
# 方式：always 收到命令即时写入，效率最慢最，但最可靠
       everysec 每秒写入，效率高，但不绝对可靠
       on 完全依赖系统，性能最后，持久化没保障
appendfsync always
```



